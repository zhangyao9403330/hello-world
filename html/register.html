<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="../css/register.css" rel="stylesheet" type="text/css" />
    <title>注册</title>
</head>

<body>
    <div class="top">
        <div class="top1">
            <ul class="left">
                <li><a href="index.html">舒华官网</a></li>
                <li><a>SHUA OVERSEA</a></li>
                <li>
                    <a><img src="../images/shouc.png">收藏舒华官方商城</a>
                </li>
                <li>
                    <a><img src="../images/weixinicon.png">官方微信</a>
                </li>
            </ul>
            <div class="right">
                <div class="right1">
                    <span>舒华商城欢迎您</span>
                    <div id="idname">
                        ，请
                        <a>登录</a>
                        <span>|</span>
                        <a>注册</a>
                        <span>|</span>
                    </div>
                </div>
                <div class="right2">
                    <span>商城公告</span>
                    <div class="dis"></div>
                    <div id="text1">暂无公告</div>
                </div>
                <div id="right3">
                    <span>购物车(<span id="shoppingcar">0</span>)</span>
                    <div id="text2">
                        购物车还没有商品,赶紧选购吧!
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="header">
        <div class="header1">
            <h1>
                <img src="../images/logo.png">
            </h1>
            <div class="center">
                <select id="province">
                                <option>请选择省</option>
                            </select><br>
                <select id="city">
                                <option>请选择市</option>
                            </select>
            </div>
            <div class="right">
                <input>
                <img src="../images/fdj-1.png">
            </div>
        </div>
    </div>
    <div class="nav">
        <div class="left"><a href="goodlist.html">全部商品分类</a>
            <ul>
                <li class="li1">跑步机/智能
                    <ul>
                        <li class="li1"><img src="../images/1 (1).jpg">跑步机/智能</li>
                        <li><img src="../images/1 (2).jpg">健身车/动感单车</li>
                        <li><img src="../images/1 (3).jpg">椭圆机/倒立机</li>
                        <li><img src="../images/1 (4).jpg">肌肉训练</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                    </ul>
                </li>
                <li>健身车/动感单车
                    <ul>
                        <li class="li1"><img src="../images/1.jpg">跑步机/智能</li>
                        <li><img src="../images/2.jpg">健身车/动感单车</li>
                        <li><img src="../images/3.jpg">椭圆机/倒立机</li>
                        <li><img src="../images/4.jpg">肌肉训练</li>
                        <li><img src="../images/5.jpg">按摩养生</li>
                        <li><img src="../images/6.jpg">按摩养生</li>
                        <li><img src="../images/7.jpg">按摩养生</li>
                        <li><img src="../images/8.jpg">按摩养生</li>
                    </ul>
                </li>
                <li>椭圆机/倒立机
                    <ul>
                        <li class="li1"><img src="../images/1 (1).jpg">跑步机/智能</li>
                        <li><img src="../images/5.jpg">按摩养生</li>
                        <li><img src="../images/6.jpg">按摩养生</li>
                        <li><img src="../images/7.jpg">按摩养生</li>
                        <li><img src="../images/8.jpg">按摩养生</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                    </ul>
                </li>
                <li>肌肉训练
                    <ul>
                        <li class="li1"><img src="../images/1.jpg">跑步机/智能</li>
                        <li><img src="../images/3.jpg">椭圆机/倒立机</li>
                        <li><img src="../images/6.jpg">按摩养生</li>
                        <li><img src="../images/7.jpg">按摩养生</li>
                        <li><img src="../images/8.jpg">按摩养生</li>
                        <li><img src="../images/1 (4).jpg">肌肉训练</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                    </ul>
                </li>
                <li>哑铃/仰卧板
                    <ul>
                        <li class="li1"><img src="../images/1 (1).jpg">跑步机/智能</li>
                        <li><img src="../images/1 (2).jpg">健身车/动感单车</li>
                        <li><img src="../images/1 (3).jpg">椭圆机/倒立机</li>
                        <li><img src="../images/1 (4).jpg">肌肉训练</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                        <li><img src="../images/6.jpg">按摩养生</li>
                        <li><img src="../images/7.jpg">按摩养生</li>
                        <li><img src="../images/8.jpg">按摩养生</li>
                    </ul>
                </li>
                <li>瑜伽运动
                    <ul>
                        <li class="li1"><img src="../images/1.jpg">跑步机/智能</li>
                        <li><img src="../images/5.jpg">按摩养生</li>
                        <li><img src="../images/6.jpg">按摩养生</li>
                        <li><img src="../images/7.jpg">按摩养生</li>
                        <li><img src="../images/8.jpg">按摩养生</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                        <li><img src="../images/1 (6).jpg">按摩养生</li>
                        <li><img src="../images/1 (8).jpg">按摩养生</li>
                    </ul>
                </li>
                <li>按摩养生
                    <ul>
                        <li class="li1"><img src="../images/1 (1).jpg">跑步机/智能</li>
                        <li><img src="../images/6.jpg">按摩养生</li>
                        <li><img src="../images/7.jpg">按摩养生</li>
                        <li><img src="../images/1 (4).jpg">肌肉训练</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                        <li><img src="../images/4.jpg">肌肉训练</li>
                        <li><img src="../images/5.jpg">按摩养生</li>
                        <li><img src="../images/6.jpg">按摩养生</li>
                    </ul>
                </li>
                <li>户外路径
                    <ul>
                        <li class="li1"><img src="../images/1.jpg">跑步机/智能</li>
                        <li><img src="../images/5.jpg">按摩养生</li>
                        <li><img src="../images/6.jpg">按摩养生</li>
                        <li><img src="../images/7.jpg">按摩养生</li>
                        <li><img src="../images/8.jpg">按摩养生</li>
                        <li><img src="../images/1 (4).jpg">肌肉训练</li>
                        <li><img src="../images/1 (5).jpg">按摩养生</li>
                    </ul>
                </li>
            </ul>
        </div>
        <ul class="center">
            <li><a href="index.html">首页</a></li>
            <li id="shuhua"><a href="goodlist.html">舒华</a>
                <ul>
                    <li class="li1">
                        <img src="../images/1.jpg">
                        <p>舒华e3 跑步机</p>
                        <div>299元起</div>
                    </li>
                    <li>
                        <img src="../images/2.jpg">
                        <p>舒华e3 跑步机</p>
                        <div>299元起</div>
                    </li>
                    <li>
                        <img src="../images/3.jpg">
                        <p>舒华e3 跑步机</p>
                        <div>299元起</div>
                    </li>
                    <li>
                        <img src="../images/4.jpg">
                        <p>舒华e3 跑步机</p>
                        <div>299元起</div>
                    </li>
                    <li>
                        <img src="../images/5.jpg">
                        <p>舒华e3 跑步机</p>
                        <div>299元起</div>
                    </li>
                    <li>
                        <img src="../images/6.jpg">
                        <p>舒华e3 跑步机</p>
                        <div>299元起</div>
                    </li>
                </ul>
            </li>
            <li><a href="goodlist.html">健身知识</a></li>
            <li><a href="goodlist.html">实体店</a></li>
            <li><a href="goodlist.html">舒华健身工程案例</a></li>
            <li><a href="goodlist.html">企业团购</a></li>
        </ul>
        <p class="right">舒华公司唯一官方商城</p>
    </div>
    <div class="box">
        <div>
            <h2>注册会员 Registered Members</h2>
            <ul class="biaodan">
                <li>
                    <p>会员昵称:</p><input type="text" id="name"><br><span id="spanname"></span></li>
                <li>
                    <p>手机号码:</p><input type="text" id="tel"><button id="Btn">发送验证码</button><br><span id="spantel"></span></li>
                <li>
                    <p>验证码:</p><input type="text" id="inputma"><br><span id="spanma"></span></li>
                <li>
                    <p>设置密码:</p><input type="text" id="pwd"><br><span id="spanpwd"></span></li>
                <li>
                    <p>确认密码:</p><input type="text" id="mpwd"></li>
            </ul>
            <button id="btn">注册</button><a href="enter.html">已有会员?登入</a>
        </div>
    </div>
</body>
<script src="../js/jquery.js"></script>
<script src="../js/cookie.js"></script>
<script>
    var province = document.getElementById("province")
    var cityInput = document.getElementById("city")
    var req = new XMLHttpRequest();
    req.open("get", "http://api.yytianqi.com/citylist/id/2", true);
    req.send();
    req.onreadystatechange = function() {
            if (req.readyState == 4 && req.status == 200) {
                var text = req.responseText;
                var list1 = JSON.parse(text);
                var list = list1["list"];
                var html = "<option>请选择省份</option>"
                for (var i = 0; i < list.length; i++) {
                    var item = list[i];
                    var itemid = item["city_id"] //取省的id
                    var itemname = item["name"] //取省的名称
                    html += "<option value=" + itemid + ">" + itemname + "</option>"
                }
                province.innerHTML = html
                province.onchange = function() {
                    var itemId = this.value //取当前省份
                    for (var i = 0; i < list.length; i++) {
                        var item = list[i];
                        var itemid = item["city_id"] //取省的id
                            //                     var itemname=item["name"]
                        if (itemid == itemId) {
                            var itemlist = item["list"]; //省下面的市集合
                            var html = ""
                            for (var j = 0; j < itemlist.length; j++) {
                                var city = itemlist[j]
                                var cityname = city["name"] //市
                                var cityid = city["city_id"]
                                html += "<option value=" + cityid + ">" + cityname + "</option>"
                            }
                            cityInput.innerHTML = html
                        }
                    }
                }
            }
        }
        // 省市联动
    $("#name").blur(function() {
        var nameinput = $("#name").val();
        var reg = /^[a-zA-Z$_]{1}[0-9a-zA-Z$_]{3,5}$/g;
        if (reg.test(nameinput)) {
            var nameinput = $("#name").val();
            $.ajax({
                type: "get",
                url: "../php/register.php",
                data: {
                    "username": nameinput,
                },
                dataType: "json",
                success: function(list) {
                    if (list["code"] == 1) {
                        $("#spanname").text("该用户已存在")
                        $("#spanname").css({
                            "color": "red"
                        })
                    } else {
                        $("#spanname").text("√")
                        $("#spanname").css({
                            "color": "#fff"
                        })
                    }
                }

            })
        } else {
            $("#spanname").text("以数字字母和$_组成，不能以数字开头，长度在4到6位")
            $("#spanname").css({
                "color": "red",
            })
            return false
        };
    })


    //用户名判断
    $("#tel").blur(function() {
        var telinput = $("#tel").val();
        var rej1 = /^[1][3|4|5|6|7|8|9][0-9]{9}$/
        if (rej1.test(telinput)) {
            $("#spantel").text("√")
            $("#spantel").css({
                "color": "#fff"
            })
        } else {
            $("#spantel").text("手机号不合法")
            $("#spantel").css({
                "color": "red",
            })
            return false
        }

    })
    var telbtn = document.getElementById("Btn");
    telbtn.onclick = function() {
        var telinput = $("#tel").val();
        var rej1 = /^[1][3|4|5|6|7|8|9][0-9]{9}$/
        if (rej1.test(telinput)) {
            telbtnthing()
        } else {
            $("#spantel").text("手机号不合法")
            $("#spantel").css({
                "color": "red",
            })
            return false
        }
    }
    var time = 60

    function telbtnthing() {
        var tel = $("#tel").val();
        $.ajax({
            type: "get",
            url: "../php/phpApiDemo/apiDemo/industrySMS.php",
            data: {
                tel: tel
            },
            dataType: "json",
            success: function(list) {
                if (list["code"] == 1) {
                    telbtn.disabled = true;
                    telbtn.onclick = null
                    telbtn.innerHTML = "过" + time + "秒后可以再次点击";
                    timer = setInterval(function() {
                        time--
                        telbtn.innerHTML = "过" + time + "秒后可以再次点击";
                        if (time == 0) {
                            clearInterval(timer);
                            telbtn.disabled = false;
                            telbtn.onclick = telbtnthing;
                            telbtn.innerHTML = "发送手机验证码";
                            time = 60;
                        }
                    }, 1000)
                } else {
                    alert("失败");
                }
            }
        })
    }
    //手机号验证加发送验证码
    $("#mpwd").blur(function() {
            var pwdinput = $("#pwd").val();
            var mpwdinput = $("#mpwd").val();
            var rej1 = /[a-zA-Z0-9]{6,10}/g
            if (pwdinput == mpwdinput) {
                if (rej1.test(pwdinput)) {
                    var regnum = /[0-9]/g;
                    var regupper = /[A-Z]/g;
                    var reglower = /[a-z]/g;
                    var count1 = 0
                    var count2 = 0
                    var count3 = 0
                    var count = 0;
                    if (regupper.test(pwdinput)) {
                        count2 = 1;
                    }
                    if (reglower.test(pwdinput)) {
                        count3 = 1;
                    }
                    if (regnum.test(pwdinput)) {
                        count1 = 1;
                    }
                    count = count1 + count2 + count3
                    if (count == 1) {
                        $("#spanpwd").text("");
                        $("#spanpwd").css({
                            "backgroundColor": "yellow",
                            "width": 50,
                        })
                    } else if (count == 2) {
                        $("#spanpwd").text("");
                        $("#spanpwd").css({
                            "backgroundColor": "blue",
                            "width": 100,
                        })
                    } else if (count == 3) {
                        $("#spanpwd").text("");
                        $("#spanpwd").css({
                            "backgroundColor": "green",
                            "width": 150,
                        })
                    }
                } else {
                    $("#spanpwd").text("以数字与字母组成的6到10位");
                    $("#spanpwd").css({
                        "color": "red",
                        backgroundColor: "white",
                        width: 200,
                    })
                }
            } else {
                $("#spanpwd").text("两次输入不相同");
                $("#spanpwd").css({
                    "color": "red",
                    backgroundColor: "white",
                    width: 150,
                })
            }
        })
        //密码判断强弱
    $("#btn").click(function() {
        var nameinput = $("#name").val();
        var reg = /^[a-zA-Z$_]{1}[0-9a-zA-Z$_]{3,5}$/g;
        var ma = $("#inputma").val();
        var tel = $("#tel").val()
        if (reg.test(nameinput)) {
            var rej1 = /^[1][3|4|5|6|7|8|9][0-9]{9}$/
            if (rej1.test(tel)) {
                var userpwd = $("#pwd").val();
                var mpwdinput = $("#mpwd").val();
                var rej2 = /[a-zA-Z0-9]{6,10}/g
                if (rej2.test(userpwd)) {
                    $.ajax({
                        type: "get",
                        url: "../php/register1.php",
                        data: {
                            ma: ma,
                            tel: tel,
                            userpwd: userpwd,
                            username: nameinput
                        },
                        dataType: "json",
                        success: function(list) {
                            if (list["code"] == 1) {
                                alert("注册成功")
                                window.location.href = "enter.html"
                            } else {
                                alert(list["msg"]);
                            }
                        }
                    })
                } else {
                    $("#spanpwd").text("以数字与字母组成的6到10位");
                    $("#spanpwd").css({
                        "color": "red"
                    })
                }
            } else {
                $("#spantel").text("手机号不合法")
                $("#spantel").css({
                    "color": "red",
                })
                return false
            }
        } else {
            $("#spanname").text("以数字字母和$_组成，不能以数字开头，长度在4到6位")
            $("#spanname").css({
                "color": "red",
            })
            return false
        };
    })
</script>

</html>